<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Interview Index | Hi, I&#39;m here</title>
    <meta name="description" content="Stella Blog">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="shortcut icon" type="image/x-icon" href="/stella/cute.gif">
    
    <link rel="preload" href="/stella/assets/css/0.styles.6825d706.css" as="style"><link rel="preload" href="/stella/assets/js/app.1fd06897.js" as="script"><link rel="preload" href="/stella/assets/js/2.fcbb7af2.js" as="script"><link rel="preload" href="/stella/assets/js/9.d8cbd975.js" as="script"><link rel="preload" href="/stella/assets/js/3.110e554a.js" as="script"><link rel="preload" href="/stella/assets/js/4.06261530.js" as="script"><link rel="prefetch" href="/stella/assets/js/10.a53d2ae6.js"><link rel="prefetch" href="/stella/assets/js/11.d74f68a2.js"><link rel="prefetch" href="/stella/assets/js/12.cfbce4fc.js"><link rel="prefetch" href="/stella/assets/js/13.eff1bf36.js"><link rel="prefetch" href="/stella/assets/js/14.ba2c5241.js"><link rel="prefetch" href="/stella/assets/js/15.75ca6a78.js"><link rel="prefetch" href="/stella/assets/js/16.72d744ac.js"><link rel="prefetch" href="/stella/assets/js/17.bbfdb29a.js"><link rel="prefetch" href="/stella/assets/js/18.9c2e61f7.js"><link rel="prefetch" href="/stella/assets/js/19.17b22b89.js"><link rel="prefetch" href="/stella/assets/js/20.e1d28102.js"><link rel="prefetch" href="/stella/assets/js/21.c4d984ab.js"><link rel="prefetch" href="/stella/assets/js/22.7206555d.js"><link rel="prefetch" href="/stella/assets/js/5.ef4b734f.js"><link rel="prefetch" href="/stella/assets/js/6.7c458166.js"><link rel="prefetch" href="/stella/assets/js/7.1abb8f91.js"><link rel="prefetch" href="/stella/assets/js/8.cfd3f758.js">
    <link rel="stylesheet" href="/stella/assets/css/0.styles.6825d706.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/stella/" class="home-link router-link-active"><!----> <span class="site-name">Hi, I'm here</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/stella/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/stella/interview.html" class="nav-link router-link-exact-active router-link-active">
  Interview
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Study Analysis" class="dropdown-title"><span class="title">Study Analysis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stella/study/express.html" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/koa.html" class="nav-link">
  Koa
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/axios.html" class="nav-link">
  Axios
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/vuex.html" class="nav-link">
  Vuex
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/router.html" class="nav-link">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/domdiff.html" class="nav-link">
  Vue DOM-Diff
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/mvvm.html" class="nav-link">
  Vue-MVVM
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/ssr.html" class="nav-link">
  Vue-SSR
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/cz.html" class="nav-link">
  Cz
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/ws.html" class="nav-link">
  ws
</a></li></ul></div></div><div class="nav-item"><a href="/stella/resume.html" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="https://github.com/StellaYangF/StellaYangF.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/stella/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/stella/interview.html" class="nav-link router-link-exact-active router-link-active">
  Interview
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Study Analysis" class="dropdown-title"><span class="title">Study Analysis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/stella/study/express.html" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/koa.html" class="nav-link">
  Koa
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/axios.html" class="nav-link">
  Axios
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/vuex.html" class="nav-link">
  Vuex
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/router.html" class="nav-link">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/domdiff.html" class="nav-link">
  Vue DOM-Diff
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/mvvm.html" class="nav-link">
  Vue-MVVM
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/ssr.html" class="nav-link">
  Vue-SSR
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/cz.html" class="nav-link">
  Cz
</a></li><li class="dropdown-item"><!----> <a href="/stella/study/ws.html" class="nav-link">
  ws
</a></li></ul></div></div><div class="nav-item"><a href="/stella/resume.html" class="nav-link">
  Resume
</a></div><div class="nav-item"><a href="https://github.com/StellaYangF/StellaYangF.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Interview Index</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/stella/interview.html#dom-事件" class="sidebar-link">DOM 事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#事件捕获-事件冒泡" class="sidebar-link">事件捕获 &amp; 事件冒泡</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#domcontentloaded-vs-load" class="sidebar-link">DOMContentLoaded VS load</a></li></ul></li><li><a href="/stella/interview.html#性能优化" class="sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#缓存" class="sidebar-link">缓存</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#发送请求" class="sidebar-link">发送请求</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#服务端响应" class="sidebar-link">服务端响应</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#页面解析与处理" class="sidebar-link">页面解析与处理</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#页面静态资源" class="sidebar-link">页面静态资源</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#首屏加载" class="sidebar-link">首屏加载</a></li></ul></li><li><a href="/stella/interview.html#css" class="sidebar-link">CSS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#root-伪类选择器" class="sidebar-link">:root 伪类选择器</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#运用骨架屏" class="sidebar-link">运用骨架屏</a></li></ul></li><li><a href="/stella/interview.html#sass" class="sidebar-link">Sass</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#安装使用" class="sidebar-link">安装使用</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#特性" class="sidebar-link">特性</a></li></ul></li><li><a href="/stella/interview.html#es6" class="sidebar-link">ES6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#set" class="sidebar-link">Set</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#weakset" class="sidebar-link">WeakSet</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#map" class="sidebar-link">Map</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#函数扩展" class="sidebar-link">函数扩展</a></li></ul></li><li><a href="/stella/interview.html#小程序" class="sidebar-link">小程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#生命周期函数" class="sidebar-link">生命周期函数</a></li></ul></li><li><a href="/stella/interview.html#去抖-节流" class="sidebar-link">去抖 节流</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/stella/interview.html#缓存-2" class="sidebar-link">缓存</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/stella/interview.html#cookie-session" class="sidebar-link">cookie &amp; session</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#session" class="sidebar-link">session</a></li></ul></li><li><a href="/stella/interview.html#执行上下文" class="sidebar-link">执行上下文</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#多个执行上下文" class="sidebar-link">多个执行上下文</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#分类" class="sidebar-link">分类</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#执行栈" class="sidebar-link">执行栈</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#执行上下文生命周期" class="sidebar-link">执行上下文生命周期</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#激活对象" class="sidebar-link">激活对象</a></li></ul></li><li><a href="/stella/interview.html#作用域" class="sidebar-link">作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#作用域链" class="sidebar-link">作用域链</a></li></ul></li><li><a href="/stella/interview.html#new-原理" class="sidebar-link">new 原理</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/stella/interview.html#http-协议" class="sidebar-link">HTTP 协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/stella/interview.html#http-0-9" class="sidebar-link">HTTP/0.9</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#http-1-0" class="sidebar-link">HTTP/1.0</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#http-1-1" class="sidebar-link">HTTP/1.1</a></li><li class="sidebar-sub-header"><a href="/stella/interview.html#http-2" class="sidebar-link">HTTP/2</a></li></ul></li><li><a href="/stella/interview.html#tcp-协议" class="sidebar-link">TCP 协议</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/stella/interview.html#websocket" class="sidebar-link">WebSocket</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/stella/interview.html#网络断开连接" class="sidebar-link">网络断开连接</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="interview-index"><a href="#interview-index" class="header-anchor">#</a> Interview Index</h1> <h2 id="dom-事件"><a href="#dom-事件" class="header-anchor">#</a> DOM 事件</h2> <h3 id="事件捕获-事件冒泡"><a href="#事件捕获-事件冒泡" class="header-anchor">#</a> 事件捕获 &amp; 事件冒泡</h3> <p><strong>顺序</strong>：先捕获，后冒泡</p> <ul><li><strong>捕获</strong>：【又外向内】某父级元素及其内部元素，绑定同类型事件如：click 时，会先触发该父级元素捕获事件，在触发当前点击元素的事件绑定</li> <li><strong>冒泡</strong>：【由内向外】，运用于事件委托，常见为列表事件，取代为每个列表 (li) 元素绑定事件为列表父元素 (ul) 绑定</li></ul> <p><strong>开启事件捕获</strong>：element.addEventListener(eventName, callback, true)，第三个参数传入 <code>true</code>，即可开启捕获。</p> <h3 id="domcontentloaded-vs-load"><a href="#domcontentloaded-vs-load" class="header-anchor">#</a> DOMContentLoaded VS load</h3> <ul><li><code>当初始的 HTML</code> 文档被完全加载和解析完成之后，<code>DOMContentLoaded</code> 事件被触发，而无需等待<strong>样式表</strong>、<strong>图像</strong>和<strong>子框架</strong>的完全加载。</li> <li><code>load</code> 应该仅用于检测一个完全加载的页面。</li> <li>这里有一个常见的错误，就是在本应使用 <code>DOMContentLoaded</code> 会更加合适的情况下，却选择使用 <code>load</code>，所以要谨慎。</li></ul> <blockquote><p>注意：<code>DOMContentLoaded</code> 事件必须等待其所属 script 之前的样式表加载解析完成才会触发。
顺序加载原因。</p></blockquote> <div class="highlight"><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;css.css&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3 seconds passed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div></div> <p>上面代码，如果将 link 置于 script 之后，就会立即打印。</p> <blockquote><p>Note: <strong>同步</strong> JavaScript 会暂停 DOM 的解析。
GUI 渲染线程与 JS 引擎线程互斥</p></blockquote> <div class="highlight"><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;DOM fully loaded and parsed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">1000000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 这个同步脚本将延迟DOM的解析。</span>
      <span class="token comment">// 所以DOMContentLoaded事件稍后将启动。</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div></div> <p>参考: <a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/DOMContentLoaded" target="_blank" rel="noopener noreferrer">MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="性能优化"><a href="#性能优化" class="header-anchor">#</a> 性能优化</h2> <p>“从地址栏输入XXX到访问之间经历了什么？”
这一过程经历的阶段，均有优化的机会：</p> <ul><li>查询缓存</li> <li>发送请求</li> <li>等待响应</li> <li>页面解析</li> <li>下载并处理各类静态资源</li> <li>运行时</li> <li>预加载</li></ul> <p>参考：</p> <ul><li><a href="https://alienzhou.github.io/fe-performance-journey/" target="_blank" rel="noopener noreferrer">前端性能优化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://calendar.perfplanet.com/2016/a-tale-of-four-caches/" target="_blank" rel="noopener noreferrer">A Tale of Four Caches<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="缓存"><a href="#缓存" class="header-anchor">#</a> 缓存</h3> <h4 id="本地数据存储"><a href="#本地数据存储" class="header-anchor">#</a> 本地数据存储</h4> <p>直接在业务代码侧进行缓存处理。缓存方式包括 <code>localStorage</code>, <code>sessionStorage</code>, <a href="https://medium.com/free-code-camp/a-quick-but-complete-guide-to-indexeddb-25f030425501" target="_blank" rel="noopener noreferrer">indexedDB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>例如，我们的页面上有一个日更新的榜单，我们可以做一个当日缓存：</p> <div class="highlight"><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 当用户加载站点中的榜单组件时，可以通过该方法获取榜单数据</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">readListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'listInfo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isExpired</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>time<span class="token punctuation">,</span> <span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'listInfo'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            time<span class="token operator">:</span> <span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            list<span class="token operator">:</span> list
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> info<span class="token punctuation">.</span>list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p>对于一些特殊的、轻量级的业务数据，可以考虑使用本地存储作为缓存。</p> <p><code>Local/session</code> 存储体积小(且不一致)</p> <ul><li>浏览器实现可为每个站点提供 2MB - 10MB 控件</li></ul> <p><code>indexDB</code> 是一种异步缓存 API，不会阻塞 UI 线程。</p> <ul><li>key/value 存储</li> <li>数据存储不受限</li> <li>支持所有现代浏览器</li> <li>支持事务、版本控制，提供良好性能</li> <li>跨域无法访问</li></ul> <p><code>Web SQL</code> 已废弃</p> <h4 id="内存缓存-memory"><a href="#内存缓存-memory" class="header-anchor">#</a> 内存缓存 Memory</h4> <p>webpack 进行懒加载时，使用 JSONP 形式引入，且使用 <a href="https://calendar.perfplanet.com/2013/big-bad-preloader/" target="_blank" rel="noopener noreferrer">preloader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，预抓取出其他子页面可能会用到内容，存储在 memory cache 中</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>preload<span class="token punctuation">'</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>xxx.js<span class="token punctuation">'</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>javascript<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><ul><li>不关心 HTTP语义
如：<code>max-age=0</code> 或者 <code>no-cache</code> <code>Cache-Control</code></li></ul> <p>补充：</p> <ul><li>no-cache：是把资源进行了本地缓存，在浏览器使用缓存之前，会使用 <code>last-Modified</code> 和 <code>Etag</code> 往返浏览器进行对比，判断时间和唯一标识符和服务器的是否一致，一致的话304使用缓存，不一致的话请求服务器。</li> <li>no-store: 禁用本地缓存</li></ul> <h4 id="cache-api"><a href="#cache-api" class="header-anchor">#</a> Cache API</h4> <p>提供给了客户端构建请求缓存机制的能力。</p> <p>PWA (Progressive Web App) 或者 Service Worker</p> <p>Service Worker 是一个后台运行的独立线程，可以在代码中启用</p> <div class="highlight"><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'serviceWorker'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'./sw.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 注册成功</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p>之后需要处理一些 Service Worker 的生命周期事件，而其中与这里提到的缓存功能直接相关的则是请求拦截：</p> <div class="highlight"><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// sw.js</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'fetch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果有cache则直接返回，否则通过fetch请求</span>
    e<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>
        caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> cache <span class="token operator">||</span> <span class="token function">fetch</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <p>以上代码会拦截所有的网络请求，查看是否有缓存的请求内容，如果有则返回缓存，否则会继续发送请求。与内存缓存不同，Cache API 提供的缓存可以认为是“永久性”的，关闭浏览器或离开页面之后，下次再访问仍然可以使用。</p> <p><a href="https://juejin.im/post/5aca14b6f265da237c692e6f" target="_blank" rel="noopener noreferrer">PWA 学习与实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>测试浏览器兼容性：
<a href="https://caniuse.com/#search=service%20worker" target="_blank" rel="noopener noreferrer">caniuse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="http-缓存"><a href="#http-缓存" class="header-anchor">#</a> HTTP 缓存</h4> <p>缓存分为强缓存和协商缓存。强缓存不过服务器，协商缓存需要过服务器，协商缓存返回的状态码是304。两类缓存机制可以同时存在，强缓存的优先级高于协商缓存。当执行强缓存时，如若缓存命中，则直接使用缓存数据库中的数据，不再进行缓存协商。</p> <h5 id="强缓存"><a href="#强缓存" class="header-anchor">#</a> 强缓存</h5> <p><strong>Expires(HTTP1.0)</strong>：Exprires 的值为服务端返回的数据到期时间。当再次请求时的请求时间小于返回的此时间，则直接使用缓存数据。但由于服务端时间和客户端时间可能有误差，这也将导致缓存命中的误差。另一方面，Expires是HTTP1.0的产物，故现在大多数使用Cache-Control替代。</p> <p><strong>缺点</strong>：使用的是绝对时间，如果服务端和客户端的时间产生偏差，那么会导致命中缓存产生偏差。</p> <p><strong>Pragma(HTTP1.0)</strong>：HTTP1.0时的遗留字段，当值为&quot;no-cache&quot;时强制验证缓存，Pragma禁用缓存，如果又给Expires定义一个还未到期的时间，那么Pragma字段的优先级会更高。服务端响应添加'Pragma': 'no-cache'，浏览器表现行为和刷新(F5)类似。</p> <p><strong>Cache-Control(HTTP1.1)</strong>：有很多属性，不同的属性代表的意义也不同：</p> <ul><li>private：客户端可以缓存</li> <li>public：客户端和代理服务器都可以缓存</li> <li>max-age=t：缓存内容将在t秒后失效</li> <li>no-cache：需要使用协商缓存来验证缓存数据</li> <li>no-store：所有内容都不会缓存</li></ul> <h5 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h5> <p>强缓存不是那么灵活。如果我在 300 秒内更新了资源，需要怎么通知客户端呢？常用的方式就是通过协商缓存。</p> <p>远程请求慢的一大原因就是报文体积较大。协商缓存就是希望能通过先“问一问”服务器资源到底有没有过期，来避免无谓的资源下载。这伴随的往往会是 HTTP 请求中的 304 响应码。</p> <p>一种协防缓存的方式是：服务器第一次响应时返回 Last-Modified，而浏览器在后续请求时带上其值作为 If-Modified-Since，相当于问服务端：XX 时间点之后，这个资源更新了么？服务器根据实际情况回答即可：更新了（状态码 200）或没更新（状态码 304）。</p> <p>上面是通过时间来判断是否更新，如果更新时间间隔过短，例如 1s 一下，那么使用更新时间的方式精度就不够了。所以还有一种是通过标识 —— ETag。服务器第一次响应时返回 ETag，而浏览器在后续请求时带上其值作为 If-None-Match。一般会用文件的 MD5 作为 ETag。</p> <h4 id="push-cache"><a href="#push-cache" class="header-anchor">#</a> Push Cache</h4> <p>假如很不幸，以上这些缓存你都没有命中，那么你将会碰到最后一个缓存检查 —— Push Cache。</p> <p>ush Cache 其实是 HTTP/2 的 Push 功能所带来的。简言之，过去一个 HTTP 的请求连接只能传输一个资源，而现在你在请求一个资源的同时，服务端可以为你“推送”一些其他资源 —— 你可能在在不久的将来就会用到一些资源。例如，你在请求 www.sample.com 时，服务端不仅发送了页面文档，还一起推送了 关键 CSS 样式表。这也就避免了浏览器收到响应、解析到相应位置时才会请求所带来的延后。</p> <div class="highlight"><div class="language-html extra-class"><pre class="language-html"><code>Page: Hey example.com, can I have your homepage please? 10:24
Server: Sure thing! Oh, but while I'm sending you that, here's a stylesheet, some images, some JavaScript, and some JSON. 10:24
Page: Uh, sure.10:24
Page: I'm just reading the HTML here, and it looks like I'm going to need a stylesh… oh it's the one you're already sending me, cool!10:25
</code></pre></div></div> <p>参考:
<a href="https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/" target="_blank" rel="noopener noreferrer">HTTP/2 push is tougher than I thought<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="发送请求"><a href="#发送请求" class="header-anchor">#</a> 发送请求</h3> <ul><li><p>避免多余重定向</p> <p>重定向分为 301 的永久重定向和 302 的临时重定向。</p> <p>建议贴合语义，例如服务迁移的情况下，使用 301 重定向。对 SEO 也会更友好。</p></li> <li><p>DNS 预解析</p> <p><code>&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//yourwebsite.com&quot;&gt;</code></p></li> <li><p>预先建立连接</p> <p><code>&lt;link rel=&quot;preconnect&quot; href=&quot;//sample.com&quot; crossorigin&gt;</code></p></li> <li><p>使用 CDN 静态资源，我们可以考虑通过 CDN 来降低时延。</p></li></ul> <h3 id="服务端响应"><a href="#服务端响应" class="header-anchor">#</a> 服务端响应</h3> <ul><li>使用流进行响应</li> <li>业务聚合 NodeJS</li> <li>避免代码问题
<ul><li>async await 的不当使用导致并行请求被串行化了；</li> <li>频繁地 JSON.parse 和 JSON.stringify 大对象；</li> <li>正则表达式的灾难性回溯；</li> <li>闭包导致的内存泄漏；</li> <li>CPU 密集型任务导致事件循环 delay 严重；</li> <li>未捕获的异常导致进程频繁退出，守护进程（pm2/supervisor）又将进程重启，这种频繁的启停也会比较消耗资源；</li></ul></li></ul> <h3 id="页面解析与处理"><a href="#页面解析与处理" class="header-anchor">#</a> 页面解析与处理</h3> <p>要注意的点：</p> <ul><li><p>注意资源在页面文档中的位置</p> <ul><li><p>HTML 解析为 DOM Tree，CSS 解析为 CSSOM，两者再合成 Render Tree，并行执行，非常完美。然而，当 JavaScript 入场之后，局面就变了：</p></li> <li><p>根据标准规范，在 JavaScript 中可以访问 DOM。因此当遇到 JavaScript 后会阻塞 DOM 的解析。于此同时，为避免 CSS 与 JavaScript 之间的竞态，CSSOM 的构建会阻塞 JavaScript 的脚本执行。总结起来就是 ——</p></li> <li><p>JavaScript 会阻塞 DOM 构建，而 CSSOM 的构建又回阻塞 JavaScript 的执行。</p></li></ul></li> <li><p>使用 defer 和 async</p> <ul><li>两者都会防止 JavaScript 脚本的下载阻塞 DOM 构建</li> <li>defer 会在 HTML 解析完成后，按照脚本出现的次序再顺序执行；</li> <li>async 则是下载完成就立即开始执行，同时阻塞页面解析，不保证脚本间的执行顺序。</li> <li>推荐在一些与主业务无关的 JavaScript 脚本上使用 async。例如统计脚本、监控脚本、广告脚本等。这些脚本一般都是一份独立的文件，没有外部依赖，不需要访问 DOM，也不需要有严格的执行时机限制。在这些脚本上使用 async 可以有效避免这些非核心功能的加载影响页面解析速度。</li></ul></li> <li><p>页面文档压缩</p></li></ul> <h3 id="页面静态资源"><a href="#页面静态资源" class="header-anchor">#</a> 页面静态资源</h3> <h4 id="javascript"><a href="#javascript" class="header-anchor">#</a> JavaScript</h4> <ul><li>减少不必要的请求
<ul><li>代码拆分（code split）与按需加载
<ul><li>webpack or <a href="https://requirejs.org/" target="_blank" rel="noopener noreferrer">RequireJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>代码合并</li></ul></li> <li>减少包体大小
<ul><li><p>代码压缩</p> <ul><li>uglify, production 模式下默认开始，将变量替换为短命名、去掉多余的换行符等方式</li> <li>文本压缩算法 gzip，Content-Encoding: gzip</li></ul></li> <li><p>Tree Shaking</p> <ul><li>optimization.usedExports: [] | boolean</li> <li>package.json.sideEffects</li> <li>通过检测源码中不会被使用到的部分，将其删除，从而减小代码的体积</li></ul> <div class="highlight"><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 模块 A</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 模块 B</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>add<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'module.A.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <blockquote><p>上面的代码中使用了 ESM 规范的模块语法，而没有使用 CommonJS
Tree Shaking 算是一种静态分析，而 ESM 本身是一种的静态的模块化规范，所有依赖可以在编译期确定</p></blockquote></li> <li><p>优化 polyfill 的使用</p> <ul><li>用于在非兼容浏览器上也能使用新特性的 API。后续升级不用改动业务代码，只需要删除相应的 polyfill 即可。</li> <li><a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener noreferrer">browserslist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><p>webpack</p> <ul><li>webpack-bundle-analyzer 这个工具来查看打包代码里面各个模块的占用大小。</li> <li><a href="https://github.com/GoogleChromeLabs/webpack-libs-optimizations" target="_blank" rel="noopener noreferrer">一些建议可以帮助你减小 bundle 的体积<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></li> <li>解析与执行
除了 JavaScript 下载需要耗时外，脚本的解析与执行也是会消耗时间的
<ul><li>JavaScript 的解析耗时</li> <li>避免 Long Task</li> <li>针对代码的优化</li></ul></li> <li>缓存
<ul><li>发布与部署</li> <li><a href="https://www.zhihu.com/question/20790576/answer/32602154" target="_blank" rel="noopener noreferrer">大公司里怎样开发和部署前端代码？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>将基础库代码打包合并</li> <li>减少 webpack 编译不当带来的缓存失效
<ul><li>使用 Hash 来替代自增 ID</li> <li>将 runtime chunk 单独拆分出来</li> <li>使用 records</li></ul></li></ul></li></ul> <h3 id="首屏加载"><a href="#首屏加载" class="header-anchor">#</a> 首屏加载</h3> <ul><li>Vue-Router路由懒加载（利用Webpack的代码切割）</li> <li>使用CDN加速，将通用的库从vendor进行抽离</li> <li>Nginx的gzip压缩</li> <li>Vue异步组件
服务端渲染SSR</li> <li>如果使用了一些UI库，采用按需加载</li> <li>Webpack开启gzip压缩</li> <li>如果首屏为登录页，可以做成多入口</li> <li>Service Worker缓存文件处理</li> <li>使用link标签的rel属性设置 prefetch（这段资源将会在未来某个导航或者功能要用到，但是本资源的下载顺序权重比较低，prefetch通常用于加速下一次导航）、preload（preload将会把资源得下载顺序权重提高，使得关键数据提前下载好，优化页面打开速度）</li></ul> <h2 id="css"><a href="#css" class="header-anchor">#</a> CSS</h2> <h3 id="root-伪类选择器"><a href="#root-伪类选择器" class="header-anchor">#</a> :root 伪类选择器</h3> <p><code>:root</code> 这个 <code>CSS</code> 伪类匹配文档树的根元素。对于 <code>HTML</code> 来说，<code>:root</code> 表示 <code>&lt;html&gt;</code> 元素，除了优先级更高之外，与 <code>html</code> 选择器相同。</p> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <p>在声明全局 CSS 变量时 :root 会很有用：</p> <div class="highlight"><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">:root</span> <span class="token punctuation">{</span>
  <span class="token property">--main-color</span><span class="token punctuation">:</span> hotpink<span class="token punctuation">;</span>
  <span class="token property">--pane-padding</span><span class="token punctuation">:</span> 5px 42px<span class="token punctuation">;</span>
  <span class="token property">--card-skeleton</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>lightgrey <span class="token function">var</span><span class="token punctuation">(</span>--card-height<span class="token punctuation">)</span><span class="token punctuation">,</span> transparent 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="运用骨架屏"><a href="#运用骨架屏" class="header-anchor">#</a> 运用骨架屏</h3> <div class="el-main"><div class="card"></div></div> <div class="highlight"><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>card<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token comment">/*
 * Variables
 */</span>

<span class="token selector">:root</span> <span class="token punctuation">{</span>  
  <span class="token property">--card-padding</span><span class="token punctuation">:</span> 24px<span class="token punctuation">;</span>
  <span class="token property">--card-height</span><span class="token punctuation">:</span> 340px<span class="token punctuation">;</span>
  <span class="token property">--card-skeleton</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>lightgrey <span class="token function">var</span><span class="token punctuation">(</span>--card-height<span class="token punctuation">)</span><span class="token punctuation">,</span> transparent 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token property">--avatar-size</span><span class="token punctuation">:</span> 32px<span class="token punctuation">;</span>
  <span class="token property">--avatar-position</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--card-padding<span class="token punctuation">)</span> <span class="token function">var</span><span class="token punctuation">(</span>--card-padding<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">--avatar-skeleton</span><span class="token punctuation">:</span> <span class="token function">radial-gradient</span><span class="token punctuation">(</span>circle 16px at center<span class="token punctuation">,</span> white 99%<span class="token punctuation">,</span> transparent 0
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token property">--title-height</span><span class="token punctuation">:</span> 32px<span class="token punctuation">;</span>
  <span class="token property">--title-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">--title-position</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--card-padding<span class="token punctuation">)</span> 180px<span class="token punctuation">;</span>
  <span class="token property">--title-skeleton</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>white <span class="token function">var</span><span class="token punctuation">(</span>--title-height<span class="token punctuation">)</span><span class="token punctuation">,</span> transparent 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token property">--desc-line-height</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token property">--desc-line-skeleton</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>white <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-height<span class="token punctuation">)</span><span class="token punctuation">,</span> transparent 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">--desc-line-1-width</span><span class="token punctuation">:</span>230px<span class="token punctuation">;</span>
  <span class="token property">--desc-line-1-position</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--card-padding<span class="token punctuation">)</span> 242px<span class="token punctuation">;</span>
  <span class="token property">--desc-line-2-width</span><span class="token punctuation">:</span>180px<span class="token punctuation">;</span>
  <span class="token property">--desc-line-2-position</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--card-padding<span class="token punctuation">)</span> 265px<span class="token punctuation">;</span>
  
  <span class="token property">--footer-height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
  <span class="token property">--footer-position</span><span class="token punctuation">:</span> 0 <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--card-height<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--footer-height<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">--footer-skeleton</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>white <span class="token function">var</span><span class="token punctuation">(</span>--footer-height<span class="token punctuation">)</span><span class="token punctuation">,</span> transparent 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token property">--blur-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">--blur-size</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--blur-width<span class="token punctuation">)</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--card-height<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--footer-height<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * Card Skeleton for Loading
 */</span>

<span class="token selector">.card</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span> //demo
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--card-height<span class="token punctuation">)</span><span class="token selector">;
  
  &amp;:empty::after</span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span>block<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span>6px<span class="token punctuation">;</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 10px 45px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span>0<span class="token punctuation">,</span>0<span class="token punctuation">,</span> .1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token property">background-image</span><span class="token punctuation">:</span>
      <span class="token function">linear-gradient</span><span class="token punctuation">(</span>
        90deg<span class="token punctuation">,</span> 
        <span class="token function">rgba</span><span class="token punctuation">(</span>lightgrey<span class="token punctuation">,</span> 0<span class="token punctuation">)</span> 0<span class="token punctuation">,</span> 
        <span class="token function">rgba</span><span class="token punctuation">(</span>lightgrey<span class="token punctuation">,</span> .8<span class="token punctuation">)</span> 50%<span class="token punctuation">,</span> 
        <span class="token function">rgba</span><span class="token punctuation">(</span>lightgrey<span class="token punctuation">,</span> 0<span class="token punctuation">)</span> 100%
      <span class="token punctuation">)</span><span class="token punctuation">,</span>                          //animation blur
      <span class="token function">var</span><span class="token punctuation">(</span>--title-skeleton<span class="token punctuation">)</span><span class="token punctuation">,</span>      //title
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-skeleton<span class="token punctuation">)</span><span class="token punctuation">,</span>  //desc1
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-skeleton<span class="token punctuation">)</span><span class="token punctuation">,</span>  //desc2
      <span class="token function">var</span><span class="token punctuation">(</span>--avatar-skeleton<span class="token punctuation">)</span><span class="token punctuation">,</span>     //avatar
      <span class="token function">var</span><span class="token punctuation">(</span>--footer-skeleton<span class="token punctuation">)</span><span class="token punctuation">,</span>     //footer bar
      <span class="token function">var</span><span class="token punctuation">(</span>--card-skeleton<span class="token punctuation">)</span>        //card
    <span class="token punctuation">;</span>

    <span class="token property">background-size</span><span class="token punctuation">:</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--blur-size<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--title-width<span class="token punctuation">)</span> <span class="token function">var</span><span class="token punctuation">(</span>--title-height<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-1-width<span class="token punctuation">)</span> <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-height<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-2-width<span class="token punctuation">)</span> <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-height<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--avatar-size<span class="token punctuation">)</span> <span class="token function">var</span><span class="token punctuation">(</span>--avatar-size<span class="token punctuation">)</span><span class="token punctuation">,</span>
      100% <span class="token function">var</span><span class="token punctuation">(</span>--footer-height<span class="token punctuation">)</span><span class="token punctuation">,</span>
      100% 100%
    <span class="token punctuation">;</span>
    
    <span class="token property">background-position</span><span class="token punctuation">:</span>
      -150% 0<span class="token punctuation">,</span>                      //animation
      <span class="token function">var</span><span class="token punctuation">(</span>--title-position<span class="token punctuation">)</span><span class="token punctuation">,</span>        //title
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-1-position<span class="token punctuation">)</span><span class="token punctuation">,</span>  //desc1
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-2-position<span class="token punctuation">)</span><span class="token punctuation">,</span>  //desc2
      <span class="token function">var</span><span class="token punctuation">(</span>--avatar-position<span class="token punctuation">)</span><span class="token punctuation">,</span>       //avatar
      <span class="token function">var</span><span class="token punctuation">(</span>--footer-position<span class="token punctuation">)</span><span class="token punctuation">,</span>       //footer bar
      0 0                           //card
    <span class="token punctuation">;</span>

    <span class="token property">background-repeat</span><span class="token punctuation">:</span> no-repeat<span class="token punctuation">;</span>
    <span class="token property">animation</span><span class="token punctuation">:</span> loading 1.5s infinite<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@keyframes</span> loading</span> <span class="token punctuation">{</span>
  <span class="token selector">to</span> <span class="token punctuation">{</span>
    <span class="token property">background-position</span><span class="token punctuation">:</span>
      350% 0<span class="token punctuation">,</span>        
      <span class="token function">var</span><span class="token punctuation">(</span>--title-position<span class="token punctuation">)</span><span class="token punctuation">,</span>  
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-1-position<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--desc-line-2-position<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--avatar-position<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">var</span><span class="token punctuation">(</span>--footer-position<span class="token punctuation">)</span><span class="token punctuation">,</span>
      0 0
    <span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">/* 
 * Demo Stuff
 */</span>

<span class="token selector">.el-main</span> <span class="token punctuation">{</span>
  <span class="token property">min-height</span><span class="token punctuation">:</span>100vh<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span>#FFF<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span>flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <h2 id="sass"><a href="#sass" class="header-anchor">#</a> Sass</h2> <p>一款成熟、稳定、强大的专业级 <strong>CSS 扩展语言</strong>，能兼容 CSS 语法</p> <h3 id="安装使用"><a href="#安装使用" class="header-anchor">#</a> 安装使用</h3> <p><strong>下载</strong> <code>sass</code> 基于 <code>Ruby</code> 语言开发而成，因此安装 <code>sass</code> 前需要 <a href="http://rubyinstaller.org/downloads" target="_blank" rel="noopener noreferrer">安装 Ruby<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。（注:mac下自带Ruby无需在安装Ruby!）</p> <blockquote><p>npm i sass</p></blockquote> <p><strong>编译</strong></p> <blockquote><p>sass input.scss output.css</p></blockquote> <p><strong>监听</strong></p> <blockquote><p>sass --watch input.scss:output.css
监听整个目录
sass --watch app/sass:public/stylesheets</p></blockquote> <h3 id="特性"><a href="#特性" class="header-anchor">#</a> 特性</h3> <h4 id="使用变量"><a href="#使用变量" class="header-anchor">#</a> 使用变量</h4> <blockquote><p>$ 符号标识变量，比如：$highlight-color</p></blockquote> <ul><li>声明变量</li> <li>变量引用</li> <li>下划线或中划线均可</li></ul> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token variable-line"><span class="token variable">$link-color</span><span class="token punctuation">:</span> blue;</span>
<span class="token selector">a {</span>
<span class="token property-line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$link_color</span>;</span>
<span class="token selector">}</span>

<span class="token comment">//编译后</span>

<span class="token selector">a {</span>
<span class="token property-line">  <span class="token property">color</span><span class="token punctuation">:</span> blue;</span>
<span class="token selector">}</span>
</code></pre></div></div> <h4 id="嵌套-css-规则"><a href="#嵌套-css-规则" class="header-anchor">#</a> 嵌套 CSS 规则</h4> <div class="highlight"></div> <p><strong>父元素选择器标识符&amp;</strong></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token selector">article a {</span>
<span class="token property-line">  <span class="token property">color</span><span class="token punctuation">:</span> blue;</span>
<span class="token property-line">  <span class="token property">&amp;</span><span class="token punctuation">:</span><span class="token property">hover</span> { <span class="token property">color</span><span class="token punctuation">:</span> red }</span>
<span class="token selector">}</span>

<span class="token comment">// 编译后</span>
<span class="token selector">article a { color: blue }</span>
<span class="token selector">article a:hover { color: red }</span>
</code></pre></div></div> <p><strong>群组选择器的嵌套</strong></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token selector">nav, aside {</span>
  <span class="token selector">a {color: blue}</span>
<span class="token selector">}</span>

<span class="token comment">// 编译后</span>
<span class="token selector">nav a, aside a {color: blue}</span>
</code></pre></div></div> <p><strong>子组合选择器和同层组合选择器：&gt;、+和~</strong></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token selector">article {</span>
  <span class="token selector">~ article { border-top: 1px dashed #ccc }</span>
  <span class="token selector">&gt; section { background: #eee }</span>
  <span class="token selector">dl &gt; {</span>
    <span class="token selector">dt { color: #333 }</span>
    <span class="token selector">dd { color: #555 }</span>
  <span class="token selector">}</span>
  <span class="token selector">nav + &amp; { margin-top: 0 }</span>
<span class="token selector">}</span>

<span class="token comment">// 编译后</span>
<span class="token selector">article ~ article { border-top: 1px dashed #ccc }</span>
<span class="token selector">article &gt; footer { background: #eee }</span>
<span class="token selector">article dl &gt; dt { color: #333 }</span>
<span class="token selector">article dl &gt; dd { color: #555 }</span>
<span class="token selector">nav + article { margin-top: 0 }</span>
</code></pre></div></div> <p><strong>嵌套属性</strong></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token selector">nav {</span>
<span class="token property-line">  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc {</span>
<span class="token property-line">  <span class="token property">left</span><span class="token punctuation">:</span> 0px;</span>
<span class="token property-line">  <span class="token property">right</span><span class="token punctuation">:</span> 0px;</span>
  <span class="token selector">}</span>
<span class="token selector">}</span>

<span class="token comment">// 编译后</span>
<span class="token selector">nav {</span>
<span class="token property-line">  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc;</span>
<span class="token property-line">  <span class="token property">border-left</span><span class="token punctuation">:</span> 0px;</span>
<span class="token property-line">  <span class="token property">border-right</span><span class="token punctuation">:</span> 0px;</span>
<span class="token selector">}</span>
</code></pre></div></div> <h4 id="导入sass文件"><a href="#导入sass文件" class="header-anchor">#</a> 导入SASS文件</h4> <p>使用sass的@import规则并不需要指明被导入文件的全名。你可以省略.sass或.scss文件后缀</p> <p><strong>使用SASS部分文件</strong></p> <p>sass局部文件的文件名以下划线开头。这样，sass就不会在编译时单独编译这个文件输出css，而只把这个文件用作导入</p> <p>举例来说，你想导入themes/_night-sky.scss这个局部文件里的变量，你只需在样式表中写@import &quot;themes/night-sky&quot;;。</p> <p><strong>默认变量值</strong></p> <p>反复声明一个变量，只有最后一处声明有效且它会覆盖前边的值</p> <p><strong>嵌套导入</strong></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token selector">.blue-theme {@import </span><span class="token string">&quot;blue-theme&quot;</span><span class="token selector">}</span>

<span class="token comment">//生成的结果跟你直接在.blue-theme选择器内写_blue-theme.scss文件的内容完全一样。</span>

<span class="token selector">.blue-theme {</span>
  <span class="token selector">aside {</span>
<span class="token property-line">    <span class="token property">background</span><span class="token punctuation">:</span> blue;</span>
<span class="token property-line">    <span class="token property">color</span><span class="token punctuation">:</span> #fff;</span>
  <span class="token selector">}</span>
<span class="token selector">}</span>
</code></pre></div></div> <h4 id="混合器"><a href="#混合器" class="header-anchor">#</a> 混合器</h4> <p>通过sass的混合器实现大段样式的重用。</p> <p>关键字 <code>@mixin</code> className, <code>@include</code> className</p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token atrule-line"><span class="token atrule">@mixin</span> rounded-corners {</span>
<span class="token property-line">  <span class="token property">-moz-border-radius</span><span class="token punctuation">:</span> 5px;</span>
<span class="token property-line">  <span class="token property">-webkit-border-radius</span><span class="token punctuation">:</span> 5px;</span>
<span class="token property-line">  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px;</span>
<span class="token selector">}</span>

<span class="token selector">notice {</span>
<span class="token property-line">  <span class="token property">background-color</span><span class="token punctuation">:</span> green;</span>
<span class="token property-line">  <span class="token property">border</span><span class="token punctuation">:</span> 2px solid #00aa00;</span>
<span class="token atrule-line">  <span class="token atrule">@include</span> rounded-corners;</span>
<span class="token selector">}</span>


<span class="token comment">// 编译后</span>
<span class="token selector">.notice {</span>
<span class="token property-line">  <span class="token property">background-color</span><span class="token punctuation">:</span> green;</span>
<span class="token property-line">  <span class="token property">border</span><span class="token punctuation">:</span> 2px solid #00aa00;</span>
<span class="token property-line">  <span class="token property">-moz-border-radius</span><span class="token punctuation">:</span> 5px;</span>
<span class="token property-line">  <span class="token property">-webkit-border-radius</span><span class="token punctuation">:</span> 5px;</span>
<span class="token property-line">  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px;</span>
<span class="token selector">}</span>
</code></pre></div></div> <p><strong>混合器传参</strong></p> <p>用法：
<code>@mixin className(arg1, arg2, ...)</code></p> <p><code>@include className(param1, parma2, ...)</code></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token atrule-line"><span class="token atrule">@mixin</span> link-colors($normal, $hover, $visited) {</span>
<span class="token property-line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$normal</span>;</span>
<span class="token property-line">  <span class="token property">&amp;</span><span class="token punctuation">:</span><span class="token property">hover</span> { <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$hover</span>; }</span>
<span class="token property-line">  <span class="token property">&amp;</span><span class="token punctuation">:</span><span class="token property">visited</span> { <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$visited</span>; }</span>
<span class="token selector">}</span>

<span class="token selector">a {</span>
<span class="token atrule-line">  <span class="token atrule">@include</span> link-colors(blue, red, green);</span>
<span class="token selector">}</span>


<span class="token comment">// 编译后</span>
<span class="token selector">a { color: blue; }</span>
<span class="token property-line"><span class="token property">a</span><span class="token punctuation">:</span><span class="token property">hover</span> { <span class="token property">color</span><span class="token punctuation">:</span> red; }</span>
<span class="token property-line"><span class="token property">a</span><span class="token punctuation">:</span><span class="token property">visited</span> { <span class="token property">color</span><span class="token punctuation">:</span> green; }</span>
</code></pre></div></div> <blockquote><p>sass 允许通过语法<code>$name: value</code> 的形式指定每个参数的值。这种形式的传参，参数顺序就不必再在乎了，只需要保证没有漏掉参数即可：</p></blockquote> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token selector">a {</span>
<span class="token atrule-line">    <span class="token atrule">@include</span> link-colors(</span>
<span class="token variable-line">      <span class="token variable">$normal</span><span class="token punctuation">:</span> blue,</span>
<span class="token variable-line">      <span class="token variable">$visited</span><span class="token punctuation">:</span> green,</span>
<span class="token variable-line">      <span class="token variable">$hover</span><span class="token punctuation">:</span> red</span>
  <span class="token selector">);</span>
<span class="token selector">}</span>
</code></pre></div></div> <h4 id="使用选择器继承来精简css"><a href="#使用选择器继承来精简css" class="header-anchor">#</a> 使用选择器继承来精简CSS</h4> <p>关键字 <code>@extend</code></p> <div class="highlight"><div class="language-sass extra-class"><pre class="language-sass"><code><span class="token comment">//通过选择器继承继承样式</span>
<span class="token selector">.error {</span>
<span class="token property-line">  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid red;</span>
<span class="token property-line">  <span class="token property">background-color</span><span class="token punctuation">:</span> #fdd;</span>
<span class="token selector">}</span>
<span class="token selector">.seriousError {</span>
<span class="token atrule-line">  <span class="token atrule">@extend</span> .error;</span>
<span class="token property-line">  <span class="token property">border-width</span><span class="token punctuation">:</span> 3px;</span>
<span class="token selector">}</span>
</code></pre></div></div> <h2 id="es6"><a href="#es6" class="header-anchor">#</a> ES6</h2> <h3 id="set"><a href="#set" class="header-anchor">#</a> Set</h3> <p>ES6 提供了新的数据结构 Set。它类似于数组，但是成员的值都是唯一的，没有重复的值。</p> <p>Set本身是一个构造函数，用来生成 Set 数据结构。</p> <h4 id="set-实例的属性和方法"><a href="#set-实例的属性和方法" class="header-anchor">#</a> Set 实例的属性和方法</h4> <p>Set 结构的实例有以下属性。</p> <ul><li>Set.prototype.constructor：构造函数，默认就是Set函数。</li> <li>Set.prototype.size：返回Set实例的成员总数。</li></ul> <p>Set 实例的方法分为两大类：操作方法（用于操作数据）和遍历方法（用于遍历成员）。下面先介绍四个操作方法。</p> <ul><li>Set.prototype.add(value)：添加某个值，返回 Set 结构本身。</li> <li>Set.prototype.delete(value)：删除某个值，返回一个布尔值，表示删除是否成功。</li> <li>Set.prototype.has(value)：返回一个布尔值，表示该值是否为Set的成员。</li> <li>Set.prototype.clear()：清除所有成员，没有返回值。</li></ul> <h3 id="weakset"><a href="#weakset" class="header-anchor">#</a> WeakSet</h3> <ul><li>WeakSet 的成员只能是对象，而不能是其他类型的值。</li> <li>WeakSet 中的对象都是弱引用，即垃圾回收机制不考虑 WeakSet 对该对象的引用，也就是说，如果其他对象都不再引用该对象，那么垃圾回收机制会自动回收该对象所占用的内存，不考虑该对象还存在于 WeakSet 之中。</li> <li>WeakSet 的一个用处，是储存 DOM 节点，而不用担心这些节点从文档移除时，会引发内存泄漏。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> foos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    foos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">method</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>foos<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Foo.prototype.method 只能在Foo的实例上调用！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码保证了 Foo 的实例方法，只能在 Foo 的实例上调用。这里使用 WeakSet 的好处是，foos对实例的引用，不会被计入内存回收机制，所以删除实例的时候，不用考虑foos，也不会出现内存泄漏。</p> <p>三个方法：</p> <ul><li>WeakSet.prototype.add(value)：向 WeakSet 实例添加一个新成员。</li> <li>WeakSet.prototype.delete(value)：清除 WeakSet 实例的指定成员。</li> <li>WeakSet.prototype.has(value)：返回一个布尔值，表示某个值是否在 WeakSet</li></ul> <h3 id="map"><a href="#map" class="header-anchor">#</a> Map</h3> <p>Object 结构提供了“字符串—值”的对应，Map 结构提供了“值—值”的对应，是一种更完善的 Hash 结构实现。如果你需要“键值对”的数据结构，Map 比 Object 更合适。</p> <h4 id="实例方法和属性"><a href="#实例方法和属性" class="header-anchor">#</a> 实例方法和属性</h4> <ul><li>size 属性</li> <li>Map.prototype.set(key, value)</li> <li>Map.prototype.get(key)</li> <li>Map.prototype.has(key)</li> <li>Map.prototype.delete(key)</li> <li>Map.prototype.clear()</li></ul> <p>作为构造函数，Map 也可以接受一个数组作为参数。该数组的成员是一个个表示键值对的数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'Author'</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span>size <span class="token comment">// 2</span>
map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;张三&quot;</span>
map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Author&quot;</span>
</code></pre></div><h3 id="函数扩展"><a href="#函数扩展" class="header-anchor">#</a> 函数扩展</h3> <h4 id="函数的-length-属性"><a href="#函数的-length-属性" class="header-anchor">#</a> 函数的 length 属性</h4> <p>指定了默认值以后，函数的length属性，将返回没有指定默认值的参数个数。也就是说，指定了默认值后，length属性将失真。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token comment">// 1</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a <span class="token operator">=</span> <span class="token number">5</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token comment">// 0</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">5</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token comment">// 2</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token comment">// 1</span>
</code></pre></div><h4 id="参数作用域"><a href="#参数作用域" class="header-anchor">#</a> 参数作用域</h4> <ul><li>一旦设置了参数的默认值，函数进行声明初始化时，参数会形成一个单独的作用域（context）。</li> <li>等到初始化结束，这个作用域就会消失。</li> <li>这种语法行为，在不设置参数默认值时，是不会出现的。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y <span class="token operator">=</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 2</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">y <span class="token operator">=</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">y <span class="token operator">=</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ReferenceError: x is not defined</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">x <span class="token operator">=</span> x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ReferenceError: x is not defined</span>
</code></pre></div><p>上面代码中，参数x = x形成一个单独作用域。实际执行的是let x = x，由于暂时性死区的原因，这行代码会报错”x 未定义“。</p> <h4 id="尾调用"><a href="#尾调用" class="header-anchor">#</a> 尾调用</h4> <p>尾调用（Tail Call）是函数式编程的一个重要概念，本身非常简单，一句话就能说清楚，就是指某个函数的最后一步是调用另一个函数。</p> <p>尾调用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>非尾调用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 情况一</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 情况二</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 情况三</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 最后一步是 return undefined</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="尾调优化"><a href="#尾调优化" class="header-anchor">#</a> 尾调优化</h5> <p>“尾调用优化”（Tail call optimization），即只保留内层函数的调用帧。</p> <p>存调用位置和内部变量等信息。如果在函数A的内部调用函数B，那么在A的调用帧上方，还会形成一个B的调用帧。等到B运行结束，将结果返回到A，B的调用帧才会消失。如果函数B内部还调用函数C，那就还有一个C的调用帧，以此类推。所有的调用帧，就形成一个“调用栈”（call stack）。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">g</span><span class="token punctuation">(</span>m <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于</span>
<span class="token function">g</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="尾递归"><a href="#尾递归" class="header-anchor">#</a> 尾递归</h5> <p>递归非常耗费内存，因为需要同时保存成千上百个调用帧，很容易发生“栈溢出”错误（stack overflow）。但对于尾递归来说，由于只存在一个调用帧，所以永远不会发生“栈溢出”错误。
<strong>阶乘</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>计算n的阶乘，最多需要保存 n 个调用记录，复杂度 O(n) 。
<strong>阶乘优化</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> total<span class="token operator">=</span><span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span><span class="token number">1</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> total<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">*</span> total<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>复杂度 O(1)
<strong>斐波拉切</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fibonacci</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">Fibonacci</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Fibonacci</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>斐波拉切 优化</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fibonacci</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> ac1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> ac2 <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> ac2<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">Fibonacci</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> ac2<span class="token punctuation">,</span> ac1<span class="token operator">+</span>ac2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="小程序"><a href="#小程序" class="header-anchor">#</a> 小程序</h2> <h3 id="生命周期函数"><a href="#生命周期函数" class="header-anchor">#</a> 生命周期函数</h3> <ul><li>onLoad</li> <li>onShow</li> <li>onReady</li> <li>onHide</li> <li>onShow</li> <li>onUnload</li></ul> <h2 id="去抖-节流"><a href="#去抖-节流" class="header-anchor">#</a> 去抖 节流</h2> <p>去抖</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    timer <span class="token operator">&amp;&amp;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>节流</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实现二：</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timeoutId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeoutId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timeoutId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timeoutId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="缓存-2"><a href="#缓存-2" class="header-anchor">#</a> 缓存</h2> <p>作用：</p> <ul><li>减少冗余数据传输，节省带宽</li> <li>减少服务器负担，大大提高网站性能</li> <li>加快客户端加载网页速度</li></ul> <h2 id="cookie-session"><a href="#cookie-session" class="header-anchor">#</a> cookie &amp; session</h2> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h3> <p><a href="http://www.zhufengpeixun.cn/2020/html/22.cookie.html" target="_blank" rel="noopener noreferrer">参考链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>res.cookie(name, value, [, options])</p> <p>参数：</p> <ul><li>domain</li> <li>path</li> <li>httpOnly</li> <li>maxAge: Number</li> <li>expires: Date</li> <li>secure：只通过 https 协议访问</li></ul> <p>注意：</p> <ul><li>可能被客户端篡改，使用前验证合法性</li> <li>不要存储敏感数据，比如用户密码，账户余额</li> <li>使用 httpOnly 保证安全</li> <li>尽量减少 cookie 的体积</li> <li>设置正确的 domain 和 path，减少数据传输</li></ul> <p>document.cookie 可以获取 cookie</p> <h3 id="session"><a href="#session" class="header-anchor">#</a> session</h3> <p><a href="http://www.zhufengpeixun.cn/2020/html/23.session.html" target="_blank" rel="noopener noreferrer">参考链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>what:</p> <ul><li>session是另一种记录客户状态的机制，不同的是Cookie保存在客户端浏览器中，而session保存在服务器上</li> <li>客户端浏览器访问服务器的时候，服务器把客户端信息以某种形式记录在服务器上，这就是session。客户端浏览器再次访问时只需要从该Session中查找该客户的状态就可以了</li></ul> <p>区别：</p> <ul><li>cookie数据存放在客户的浏览器上，session数据放在服务器上。</li> <li>cookie不是很安全，别人可以分析存放在本地的COOKIE并进行COOKIE欺骗 考虑到安全应当使用session</li> <li>session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能 考虑到减轻服务器性能方面,应当使用COOKIE</li> <li>单个 cookie 保存的数据不能超过 4K，很多浏览器都限制一个站点最多保存20个 cookie</li></ul> <h2 id="执行上下文"><a href="#执行上下文" class="header-anchor">#</a> 执行上下文</h2> <p>函数执行时，会创建一个执行环境，即执行上下文（execution context），执行上下文创建一个 Variable Object 变量对象，存储基础类型数据和引用类型数据的在堆中存储的地址</p> <div class="language-js extra-class"><pre class="language-js"><code>ExecutionContest <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="多个执行上下文"><a href="#多个执行上下文" class="header-anchor">#</a> 多个执行上下文</h3> <p>JS 代码在执行的时候，会进入一个执行上下文，可理解为当前代码运行环境</p> <h3 id="分类"><a href="#分类" class="header-anchor">#</a> 分类</h3> <ul><li>全局执行上下文：浏览器创建，window</li> <li>函数执行上下文环境</li></ul> <h3 id="执行栈"><a href="#执行栈" class="header-anchor">#</a> 执行栈</h3> <ul><li>多个执行上下文，JS 引擎有栈来管理</li> <li>LIFO 后进先出</li> <li>栈底永远是全局上下文</li> <li>新开启一个函数执行时，会省</li></ul> <h3 id="执行上下文生命周期"><a href="#执行上下文生命周期" class="header-anchor">#</a> 执行上下文生命周期</h3> <p>两个阶段：</p> <ul><li>创建
<ul><li>创建 VO</li> <li>创建 scopeChain</li> <li>确定 this 指向</li></ul></li> <li>执行
<ul><li>变量赋值</li> <li>函数赋值</li> <li>执行</li></ul></li></ul> <h3 id="激活对象"><a href="#激活对象" class="header-anchor">#</a> 激活对象</h3> <p>变量对象会保存：</p> <ul><li>变量声明（var）</li> <li>函数参数（arguments）</li> <li>函数定义（function）
<ul><li>表达式 let xx = function(){}</li> <li>声明 function xx(){} 优先级更高</li></ul></li></ul> <h4 id="vo"><a href="#vo" class="header-anchor">#</a> VO</h4> <p>VO：Activation Object</p> <p>在函数的调用栈中，如果当前执行上下文处于函数调用栈的顶端，则意味着当前上下文处于激活状态，此时变量对象称为活动对象(AO,Activation Object) VO=&gt;AO
活动变量包含变量对象所有的属性，并有包含 this 指针</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//执行阶段 VO=&gt;AO</span>
<span class="token keyword">let</span> <span class="token constant">VO</span> <span class="token operator">=</span> <span class="token constant">AO</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    m<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token function-variable function">two</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>
<span class="token keyword">let</span> oneEC<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token constant">VO</span><span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token operator">:</span> window<span class="token punctuation">,</span>
    scopeChain<span class="token operator">:</span><span class="token punctuation">[</span><span class="token constant">VO</span><span class="token punctuation">,</span>globalVO<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="作用域"><a href="#作用域" class="header-anchor">#</a> 作用域</h2> <p>JS 中，作用域是用来规定变量访问范围的规则</p> <h3 id="作用域链"><a href="#作用域链" class="header-anchor">#</a> 作用域链</h3> <p>作用域链是由当前执行环境与上层执行环境的一系列变量对象组成的，它保证了当前执行环境对符合访问权限的变量和函数的有序访问。</p> <p>区分：</p> <ul><li>在函数创建时 确定</li> <li>this 是在当前执行上下文在执行栈顶时，确定</li></ul> <h2 id="new-原理"><a href="#new-原理" class="header-anchor">#</a> new 原理</h2> <p>new调用时，自动执行的四步操作:</p> <ul><li>创建(或者说构造)一个全新的对象</li> <li>这个对象会被执行[[原型]]链接</li> <li>这个新对象会绑定到函数调用的this</li> <li>如果函数没有返回其他对象，那么new表达式中的函数调用会自动返回这个新对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mockNew</span><span class="token punctuation">(</span><span class="token parameter">className<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>className<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">className</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> result <span class="token operator">?</span> result <span class="token operator">:</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="http-协议"><a href="#http-协议" class="header-anchor">#</a> HTTP 协议</h2> <p>基于 TCP/IP 协议的应用协议</p> <p>分类：</p> <ul><li>HTTP/0.9</li> <li>HTTP/1.0</li> <li>HTTP/1.1</li> <li>HTTP/2</li></ul> <h3 id="http-0-9"><a href="#http-0-9" class="header-anchor">#</a> HTTP/0.9</h3> <p>1991年，只能请求网页文档</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">GET</span> <span class="token operator">/</span>index<span class="token punctuation">.</span>html
</code></pre></div><h3 id="http-1-0"><a href="#http-1-0" class="header-anchor">#</a> HTTP/1.0</h3> <p>1996年</p> <p>特新：</p> <ul><li>任何格式的内容都可以发送，图片，视频等</li> <li><code>GET</code> 命令，还引入了 <code>POST</code> 命令和 <code>HEAD</code> 命令，丰富了浏览器与服务器的互动手段。</li> <li>HTTP 请求和回应的格式也变了。除了数据部分，每次通信都必须包括头信息（HTTP header），用来描述一些元数据。</li> <li>状态码（status code）、多字符集支持、多部分发送（multi-part type）、权限（authorization）、缓存（cache）、内容编码（content encoding）等。</li></ul> <p>字段：</p> <ul><li>Content-Type:
<ul><li>multipart/form-data 表单</li> <li>text/plain</li> <li>text/css</li> <li>text/html</li> <li></li></ul></li> <li>Content-Encoding:
<ul><li>gzip</li> <li>compress</li> <li>deflate</li> <li>identify</li></ul></li></ul> <p>缺点：</p> <ul><li>每个 TCP 链接只能发一个请求，请求其他数据，需重连</li> <li>TCP 链接成本高，三次握手，slow start</li> <li>非标准字段：
<ul><li>Connection: keep-alive</li></ul></li></ul> <h3 id="http-1-1"><a href="#http-1-1" class="header-anchor">#</a> HTTP/1.1</h3> <p>特性：</p> <ul><li>持久连接（persistent connection），无需声明 Connection: keep-alive
<ul><li>客户端最后一个请求，发送Connection: close，明确要求服务器关闭 TCP 链接</li></ul></li> <li>管线化 (pipeline)，同时发多个请求，顺序返回
<ul><li>对头堵塞 (Head-of-line blocking)</li></ul></li> <li>Content-Length 区分是哪个回应</li> <li>Transfer-Encoding: chunked 分块传输编码 buffer =&gt; 流</li> <li>新增了许多动词方法：<code>PUT</code>、<code>PATCH</code>、<code>HEAD</code>、 <code>OPTIONS</code>、<code>DELETE</code>。</li> <li>Host 指定服务器域名</li></ul> <h3 id="http-2"><a href="#http-2" class="header-anchor">#</a> HTTP/2</h3> <p>特性：</p> <ul><li>HTTP/1.1 头信息肯定是文本（ASCII编码），数据体可以是文本，也可以是二进制</li> <li>HTTP/2 则是一个彻底的二进制协议，头信息和数据体都是二进制，并且统称为&quot;帧&quot;（frame）：头信息帧和数据帧</li> <li>多工（multiplexing），不按顺序返回，避免 对头堵塞</li> <li>数据流</li> <li>头信息压缩
<ul><li>头信息使用gzip或compress压缩后再发送</li> <li>客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。</li></ul></li> <li>服务器推送 server push
<ul><li>服务器可以预期到客户端请求网页后，很可能会再请求静态资源，所以就主动把这些静态资源随着网页一起发给客户端了。</li></ul></li></ul> <h2 id="tcp-协议"><a href="#tcp-协议" class="header-anchor">#</a> TCP 协议</h2> <p>职责：</p> <ul><li>客户端发送请求，将 HTTP 请求报文分割成报文段，传给 IP 协议</li> <li>服务端接收请求，将收到的报文段，重组请求报文</li></ul> <p>建立、断开工作流：</p> <ul><li>C 发送 SYN</li> <li>S 相应 SYN/ACK</li> <li>C 发送 ACK</li> <li>请求 &lt;=&gt; 相应</li> <li>S FIN</li> <li>C ACK</li> <li>C FIN</li> <li>S ACK</li></ul> <h2 id="websocket"><a href="#websocket" class="header-anchor">#</a> WebSocket</h2> <p><a href="http://www.ruanyifeng.com/blog/2017/05/websocket.html" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>对比 HTTP 有个缺陷：通信只能由客户端发起</p> <p>用法:</p> <ul><li>ws.onopen</li> <li>ws.onmessage</li> <li>ws.send</li> <li>ws.onerror</li> <li>ws.bufferedAmount</li> <li>wx.onclose</li> <li>ws.readyState
<ul><li>CONNECTING 0 正在连接</li> <li>ONPEN 1 连接成功，可通信</li> <li>CLOSING 2 正在关闭</li> <li>CLOSED 3 已关闭 or 打开连接失败</li></ul></li></ul> <p>加密：wss://域名:80/443</p> <p>bi-directional messages</p> <h2 id="网络断开连接"><a href="#网络断开连接" class="header-anchor">#</a> 网络断开连接</h2> <p>检测 DNS 解析
修复</p> <ul><li>打开网络和共享中心</li> <li>更改适配器设置</li> <li>本地连接
<ul><li>右键</li> <li>诊断</li> <li>修复</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/stella/assets/js/app.1fd06897.js" defer></script><script src="/stella/assets/js/2.fcbb7af2.js" defer></script><script src="/stella/assets/js/9.d8cbd975.js" defer></script><script src="/stella/assets/js/3.110e554a.js" defer></script><script src="/stella/assets/js/4.06261530.js" defer></script>
  </body>
</html>
